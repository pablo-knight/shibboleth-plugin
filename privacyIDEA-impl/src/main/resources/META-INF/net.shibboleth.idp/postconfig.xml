<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:util="http://www.springframework.org/schema/util" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:c="http://www.springframework.org/schema/c" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"

    default-init-method="initialize" default-destroy-method="destroy">

    <!-- 
    System beans needed for extension to function, loaded after global.xml.
    The default template shows an incomplete example authentication flow descriptor which can be
    removed if not needed 
    -->
  
    <bean id="authn/privacyIDEA" parent="shibboleth.AuthenticationFlow"
            p:order="%{xxx.order:1000}"
            p:nonBrowserSupported="%{xxx.nonBrowserSupported:true}"
            p:passiveAuthenticationSupported="%{xxx.passiveAuthenticationSupported:true}"
            p:forcedAuthenticationSupported="%{xxx.forcedAuthenticationSupported:true}"
            p:proxyRestrictionsEnforced="%{xxx.proxyRestrictionsEnforced:%{idp.authn.enforceProxyRestrictions:true}}"
            p:proxyScopingEnforced="%{xxx.proxyScopingEnforced:false}"
            p:discoveryRequired="%{xxx.discoveryRequired:false}"
            p:lifetime="%{xxx.lifetime:%{idp.authn.defaultLifetime:PT1H}}"
            p:inactivityTimeout="%{xxx.inactivityTimeout:%{idp.authn.defaultTimeout:PT30M}}"
            p:reuseCondition-ref="#{'%{xxx.reuseCondition:shibboleth.Conditions.TRUE}'.trim()}"
            p:activationCondition-ref="#{'%{xxx.activationCondition:shibboleth.Conditions.TRUE}'.trim()}">
        <property name="supportedPrincipals">
            <list>
                <bean parent="shibboleth.SAML2AuthnContextClassRef"
                    c:classRef="class-ref" />
                <bean parent="shibboleth.SAML1AuthenticationMethod"
                    c:method="auth-ref" />
            </list>
        </property>
        <property name="supportedPrincipalsByString">
            <bean parent="shibboleth.CommaDelimStringArray"
                c:_0="#{'%{xxx.supportedPrincipals:}'.trim()}" />
        </property>
    </bean>
  
</beans>